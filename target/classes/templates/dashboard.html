<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Smart Crop Recommendation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

    <!-- ====== Navbar ====== -->
    <nav class="top-navbar">
        <div class="container d-flex justify-content-between align-items-center">
            <a class="brand" href="#">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 20h10"/><path d="M10 20c5.5-2.5.8-6.4 3-10"/><path d="M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z"/><path d="M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z"/></svg>
                Smart Crop Recommendation
            </a>
            <div class="user-pill">
                <span class="user-name" th:text="${userName}">User</span>
                <span class="role-badge" th:text="${userRole}">Role</span>
                <a class="logout-btn" th:href="@{/logout}">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right:3px"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                    Logout
                </a>
            </div>
        </div>
    </nav>

    <div class="container py-4">

        <!-- ====== Page Header ====== -->
        <div class="page-header">
            <h1>Crop Recommendation Dashboard</h1>
            <p class="subtitle">Analyze soil parameters and get AI-powered crop recommendations</p>
        </div>

        <!-- ====== Recommendation Card ====== -->
        <div class="glass-card mb-4">
            <div class="card-head">
                <div class="card-icon green">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10H12V2z"/><path d="M20 12a8 8 0 1 0-16 0"/></svg>
                </div>
                <h2>Soil Analysis &amp; Recommendation</h2>
            </div>
            <div class="card-body-custom">
                <div class="input-grid">
                    <!-- Nitrogen -->
                    <div class="field-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 12h8M12 8v8"/></svg>
                            Nitrogen (N)
                            <span class="tooltip-icon">?<span class="tip-text">Nitrogen promotes leaf growth. Typical range: 0‚Äì200 kg/ha</span></span>
                        </label>
                        <input type="number" step="0.1" min="0" max="200" id="recN" placeholder="e.g. 80" value="80" required>
                        <span class="unit">kg/ha</span>
                    </div>
                    <!-- Phosphorus -->
                    <div class="field-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22V2l-4 4m8-4-4 4"/><circle cx="12" cy="16" r="4"/></svg>
                            Phosphorus (P)
                            <span class="tooltip-icon">?<span class="tip-text">Phosphorus aids root development and flowering. Range: 0‚Äì200 kg/ha</span></span>
                        </label>
                        <input type="number" step="0.1" min="0" max="200" id="recP" placeholder="e.g. 40" value="40" required>
                        <span class="unit">kg/ha</span>
                    </div>
                    <!-- Potassium -->
                    <div class="field-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                            Potassium (K)
                            <span class="tooltip-icon">?<span class="tip-text">Potassium strengthens plant structure and disease resistance. Range: 0‚Äì200 kg/ha</span></span>
                        </label>
                        <input type="number" step="0.1" min="0" max="200" id="recK" placeholder="e.g. 40" value="40" required>
                        <span class="unit">kg/ha</span>
                    </div>
                    <!-- Soil pH -->
                    <div class="field-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2"/><path d="M8.5 2h7"/></svg>
                            Soil pH
                            <span class="tooltip-icon">?<span class="tip-text">Soil acidity/alkalinity. 7 is neutral, below is acidic, above is alkaline. Range: 0‚Äì14</span></span>
                        </label>
                        <input type="number" step="0.1" min="0" max="14" id="recPh" placeholder="e.g. 6.5" value="6.5" required>
                        <span class="unit">pH</span>
                    </div>
                    <!-- Rainfall -->
                    <div class="field-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"/><path d="M16 14v6"/><path d="M8 14v6"/><path d="M12 16v6"/></svg>
                            Rainfall
                            <span class="tooltip-icon">?<span class="tip-text">Annual rainfall in millimeters. Used to match crops suited for your climate. Range: 0‚Äì500 mm</span></span>
                        </label>
                        <input type="number" step="0.1" min="0" max="500" id="recMoisture" placeholder="e.g. 150" value="50" required>
                        <span class="unit">mm</span>
                    </div>
                </div>

                <!-- Location + Submit -->
                <div class="location-row">
                    <div class="field-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 1 1 16 0z"/><circle cx="12" cy="10" r="3"/></svg>
                            Location (Optional)
                        </label>
                        <input type="text" id="recLocation" placeholder="e.g. Mumbai, London">
                    </div>
                    <button type="button" class="btn-gradient" id="getRecBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                        Get Recommendation
                    </button>
                </div>

                <!-- Result -->
                <div id="recResult" class="mt-4"></div>
            </div>
        </div>

        <!-- ====== Farmer Section: NPK Trend + Recent Recommendations ====== -->
        <div id="farmerSection" class="d-none">
            <div class="row g-4 mb-4">
                <div class="col-lg-7">
                    <div class="glass-card">
                        <div class="card-head">
                            <div class="card-icon blue">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                            </div>
                            <h2>NPK Trend ‚Äî Your Soil Data</h2>
                        </div>
                        <div class="card-body-custom chart-wrapper" id="npkChartContainer">
                            <canvas id="npkChart" height="120"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5">
                    <div class="glass-card">
                        <div class="card-head">
                            <div class="card-icon purple">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                            </div>
                            <h2>Recent Recommendations</h2>
                        </div>
                        <div class="card-body-custom chart-wrapper" id="farmerRecChartContainer">
                            <canvas id="farmerRecChart" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ====== Admin Section ====== -->
        <div id="adminSection" class="d-none">
            <div class="glass-card mb-4">
                <div class="card-head">
                    <div class="card-icon amber">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"/><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"/><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"/></svg>
                    </div>
                    <h2>Most Recommended Crops (All Users)</h2>
                </div>
                <div class="card-body-custom chart-wrapper">
                    <canvas id="adminChart" height="120"></canvas>
                </div>
            </div>
        </div>

        <!-- ====== Officer Section ====== -->
        <div id="officerSection" class="d-none">
            <div class="glass-card mb-4">
                <div class="card-head">
                    <div class="card-icon blue">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"/><path d="M16 14v6"/><path d="M8 14v6"/><path d="M12 16v6"/></svg>
                    </div>
                    <h2>Rainfall &amp; Temperature Trend</h2>
                </div>
                <div class="card-body-custom">
                    <div class="officer-location-bar">
                        <div class="field-group">
                            <label>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 1 1 16 0z"/><circle cx="12" cy="10" r="3"/></svg>
                                Weather Location
                            </label>
                            <input type="text" id="officerLocation" placeholder="e.g. London, Mumbai">
                        </div>
                        <button type="button" class="btn-secondary-custom" id="officerLoadBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
                            Load Data
                        </button>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="officerChart" height="120"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <p class="text-muted small d-none" id="noDataMsg">Loading dashboard...</p>

        <div class="footer-note">&copy; 2026 Smart Crop Recommendation System</div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script th:inline="javascript">
        const userRole = /*[[${userRole}]]*/ 'FARMER';
        const userId = /*[[${userId}]]*/ 0;

        /* ---------- Crop Emojis ---------- */
        const cropEmoji = {
            'Rice':'üåæ','Wheat':'üåæ','Maize':'üåΩ','Cotton':'‚òÅÔ∏è','Sugarcane':'üéã',
            'Jute':'üßµ','Coconut':'ü••','Papaya':'üçà','Orange':'üçä','Apple':'üçé',
            'Grapes':'üçá','Mango':'ü•≠','Bean':'ü´ò','Lentil':'ü´ò','Chickpea':'ü´ò'
        };

        /* ---------- Chart.js Defaults ---------- */
        Chart.defaults.font.family = "'Inter', system-ui, sans-serif";
        Chart.defaults.font.size = 12;
        Chart.defaults.plugins.legend.labels.usePointStyle = true;
        Chart.defaults.plugins.legend.labels.padding = 16;

        function getAuthHeaders() {
            return { 'Content-Type': 'application/json' };
        }

        /* ---------- Section Visibility ---------- */
        function showSection(role) {
            document.getElementById('farmerSection').classList.add('d-none');
            document.getElementById('adminSection').classList.add('d-none');
            document.getElementById('officerSection').classList.add('d-none');
            if (role === 'FARMER')  document.getElementById('farmerSection').classList.remove('d-none');
            else if (role === 'ADMIN')   document.getElementById('adminSection').classList.remove('d-none');
            else if (role === 'OFFICER') document.getElementById('officerSection').classList.remove('d-none');
        }

        /* ---------- Empty State HTML ---------- */
        function emptyState(message) {
            return '<div class="empty-state"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"/><path d="M12 8v4"/><circle cx="12" cy="16" r=".5"/></svg><p>' + message + '</p></div>';
        }

        /* ---------- Farmer Dashboard ---------- */
        function loadFarmerDashboard() {
            fetch('/api/dashboard/farmer', { credentials: 'include', headers: getAuthHeaders() })
                .then(r => r.ok ? r.json() : Promise.reject(r))
                .then(data => {
                    showSection('FARMER');
                    document.getElementById('noDataMsg').classList.add('d-none');
                    const labels = data.npkLabels || [];
                    if (labels.length === 0) {
                        document.getElementById('npkChartContainer').innerHTML = emptyState('No soil data yet. Submit a recommendation to start tracking.');
                    } else {
                        new Chart(document.getElementById('npkChart'), {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [
                                    { label: 'Nitrogen', data: data.nitrogen || [], borderColor: '#16a34a', backgroundColor: 'rgba(22,163,74,.08)', fill: true, tension: 0.4, pointRadius: 4, pointHoverRadius: 6 },
                                    { label: 'Phosphorus', data: data.phosphorus || [], borderColor: '#dc2626', backgroundColor: 'rgba(220,38,38,.08)', fill: true, tension: 0.4, pointRadius: 4, pointHoverRadius: 6 },
                                    { label: 'Potassium', data: data.potassium || [], borderColor: '#2563eb', backgroundColor: 'rgba(37,99,235,.08)', fill: true, tension: 0.4, pointRadius: 4, pointHoverRadius: 6 }
                                ]
                            },
                            options: {
                                responsive: true,
                                plugins: { legend: { position: 'top' } },
                                scales: {
                                    y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,.04)' } },
                                    x: { grid: { display: false } }
                                }
                            }
                        });
                    }
                    const recs = data.recommendations || [];
                    const cropCounts = {};
                    recs.forEach(r => { const n = r.crop?.cropName || 'Unknown'; cropCounts[n] = (cropCounts[n] || 0) + 1; });
                    const recLabels = Object.keys(cropCounts);
                    const recData = Object.values(cropCounts);
                    if (recLabels.length > 0) {
                        const colors = ['#16a34a','#059669','#0d9488','#0891b2','#2563eb','#7c3aed','#c026d3','#e11d48'];
                        new Chart(document.getElementById('farmerRecChart'), {
                            type: 'doughnut',
                            data: {
                                labels: recLabels,
                                datasets: [{ data: recData, backgroundColor: colors.slice(0, recLabels.length), borderWidth: 2, borderColor: '#fff' }]
                            },
                            options: {
                                responsive: true,
                                cutout: '60%',
                                plugins: { legend: { position: 'bottom' } }
                            }
                        });
                    } else {
                        document.getElementById('farmerRecChartContainer').innerHTML = emptyState('No recommendations yet. Try analyzing your soil!');
                    }
                })
                .catch(() => { showSection('FARMER'); document.getElementById('noDataMsg').textContent = 'Failed to load farmer dashboard.'; document.getElementById('noDataMsg').classList.remove('d-none'); });
        }

        /* ---------- Admin Dashboard ---------- */
        function loadAdminDashboard() {
            fetch('/api/dashboard/admin', { credentials: 'include', headers: getAuthHeaders() })
                .then(r => r.ok ? r.json() : Promise.reject(r))
                .then(data => {
                    showSection('ADMIN');
                    document.getElementById('noDataMsg').classList.add('d-none');
                    const labels = data.topCropNames || [];
                    const counts = data.topCropCounts || [];
                    if (labels.length === 0) {
                        document.getElementById('adminChart').parentElement.innerHTML = emptyState('No recommendation data across users yet.');
                    } else {
                        new Chart(document.getElementById('adminChart'), {
                            type: 'bar',
                            data: {
                                labels: labels,
                                datasets: [{
                                    label: 'Recommendation count',
                                    data: counts,
                                    backgroundColor: 'rgba(22,163,74,0.7)',
                                    borderColor: '#16a34a',
                                    borderWidth: 1,
                                    borderRadius: 6,
                                    barThickness: 32
                                }]
                            },
                            options: {
                                responsive: true,
                                indexAxis: 'y',
                                scales: {
                                    x: { beginAtZero: true, grid: { color: 'rgba(0,0,0,.04)' } },
                                    y: { grid: { display: false } }
                                }
                            }
                        });
                    }
                })
                .catch(() => { showSection('ADMIN'); document.getElementById('noDataMsg').textContent = 'Failed to load admin dashboard.'; document.getElementById('noDataMsg').classList.remove('d-none'); });
        }

        /* ---------- Officer Dashboard ---------- */
        function loadOfficerDashboard(location) {
            const url = location ? '/api/dashboard/officer?location=' + encodeURIComponent(location) : '/api/dashboard/officer';
            fetch(url, { credentials: 'include', headers: getAuthHeaders() })
                .then(r => r.ok ? r.json() : Promise.reject(r))
                .then(data => {
                    showSection('OFFICER');
                    document.getElementById('noDataMsg').classList.add('d-none');
                    const labels = data.rainfallLabels || [];
                    if (labels.length === 0) {
                        document.getElementById('officerChart').parentElement.innerHTML = emptyState('No weather data. Enter a location and click Load Data.');
                    } else {
                        new Chart(document.getElementById('officerChart'), {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [
                                    { label: 'Rainfall (mm)', data: data.rainfall || [], borderColor: '#2563eb', backgroundColor: 'rgba(37,99,235,.08)', fill: true, tension: 0.4, pointRadius: 4 },
                                    { label: 'Temperature (¬∞C)', data: data.temperature || [], borderColor: '#dc2626', backgroundColor: 'rgba(220,38,38,.08)', fill: true, tension: 0.4, pointRadius: 4 }
                                ]
                            },
                            options: {
                                responsive: true,
                                plugins: { legend: { position: 'top' } },
                                scales: {
                                    y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,.04)' } },
                                    x: { grid: { display: false } }
                                }
                            }
                        });
                    }
                })
                .catch(() => { showSection('OFFICER'); document.getElementById('noDataMsg').textContent = 'Failed to load officer dashboard.'; document.getElementById('noDataMsg').classList.remove('d-none'); });
        }

        /* ---------- Validation ---------- */
        function validateInputs() {
            const fields = [
                { id: 'recN', min: 0, max: 200, name: 'Nitrogen' },
                { id: 'recP', min: 0, max: 200, name: 'Phosphorus' },
                { id: 'recK', min: 0, max: 200, name: 'Potassium' },
                { id: 'recPh', min: 0, max: 14, name: 'Soil pH' },
                { id: 'recMoisture', min: 0, max: 500, name: 'Rainfall' }
            ];
            for (const f of fields) {
                const el = document.getElementById(f.id);
                const v = parseFloat(el.value);
                if (isNaN(v) || v < f.min || v > f.max) {
                    el.focus();
                    el.style.borderColor = '#ef4444';
                    return f.name + ' must be between ' + f.min + ' and ' + f.max;
                } else {
                    el.style.borderColor = '';
                }
            }
            return null;
        }

        /* ---------- Get Recommendation ---------- */
        document.getElementById('getRecBtn').onclick = function() {
            const err = validateInputs();
            if (err) {
                document.getElementById('recResult').innerHTML =
                    '<div class="result-card error" style="animation:slideUp .3s ease"><p style="margin:0;font-weight:600;color:#dc2626">‚ö†Ô∏è ' + err + '</p></div>';
                return;
            }
            const btn = this;
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner" style="width:18px;height:18px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite;display:inline-block"></span> Analyzing...';

            const payload = {
                soilData: {
                    nitrogen: parseFloat(document.getElementById('recN').value) || 0,
                    phosphorus: parseFloat(document.getElementById('recP').value) || 0,
                    potassium: parseFloat(document.getElementById('recK').value) || 0,
                    ph: parseFloat(document.getElementById('recPh').value) || 0,
                    moisture: parseFloat(document.getElementById('recMoisture').value) || 0
                },
                location: document.getElementById('recLocation').value.trim() || null
            };

            fetch('/api/recommendation', {
                method: 'POST',
                credentials: 'include',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
            .then(r => r.ok ? r.json() : r.json().then(e => Promise.reject(e)))
            .then(data => {
                const name = data.cropName || 'N/A';
                const score = data.confidenceScore != null ? data.confidenceScore : 0;
                const emoji = cropEmoji[name] || 'üå±';
                const scoreColor = score >= 70 ? '#16a34a' : score >= 40 ? '#d97706' : '#dc2626';

                document.getElementById('recResult').innerHTML =
                    '<div class="result-card">' +
                    '  <div class="result-label">üéØ Recommendation Result</div>' +
                    '  <div class="crop-name"><span class="crop-emoji">' + emoji + '</span> ' + name + '</div>' +
                    '  <div class="confidence-section">' +
                    '    <div class="confidence-label"><span>Confidence Score</span><span style="color:' + scoreColor + ';font-weight:700">' + score.toFixed(1) + '%</span></div>' +
                    '    <div class="confidence-bar"><div class="confidence-fill" style="width:0%;background:linear-gradient(90deg,' + scoreColor + ',' + scoreColor + 'cc)"></div></div>' +
                    '  </div>' +
                    '  <div class="message-text">' + (data.message || '') + '</div>' +
                    '</div>';

                // Animate the progress bar
                setTimeout(() => {
                    const fill = document.querySelector('.confidence-fill');
                    if (fill) fill.style.width = score.toFixed(1) + '%';
                }, 80);
            })
            .catch(e => {
                document.getElementById('recResult').innerHTML =
                    '<div class="result-card error"><p style="margin:0;font-weight:600;color:#dc2626">‚ùå ' + (e.message || 'Request failed. Please try again.') + '</p></div>';
            })
            .finally(() => {
                btn.disabled = false;
                btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg> Get Recommendation';
            });
        };

        /* ---------- Init Dashboard ---------- */
        if (userRole === 'FARMER') loadFarmerDashboard();
        else if (userRole === 'ADMIN') loadAdminDashboard();
        else if (userRole === 'OFFICER') {
            showSection('OFFICER');
            document.getElementById('officerLoadBtn').onclick = () => loadOfficerDashboard(document.getElementById('officerLocation').value.trim());
        } else {
            document.getElementById('noDataMsg').textContent = 'Unknown role.';
            document.getElementById('noDataMsg').classList.remove('d-none');
        }
    </script>
</body>
</html>
